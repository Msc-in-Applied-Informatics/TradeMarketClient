<div class="inventory-dashboard">
  <header class="inventory-header">
    <div class="title-group">
      <h1>Διαχείριση Αποθέματος</h1>
      <p class="subtitle">Δείτε, επεξεργαστείτε ή επαναφέρετε τα προϊόντα του καταστήματός σας</p>
    </div>
    <button mat-flat-button color="primary" class="add-btn" (click)="addProduct()">
      <mat-icon>add_circle</mat-icon>
      Προσθήκη Προϊόντος
    </button>
  </header>

  <div class="loading-shade" *ngIf="isLoading">
    <mat-spinner diameter="50"></mat-spinner>
  </div>

  <div class="content-card mat-elevation-z3" *ngIf="!isLoading">
    <div class="table-container">
      
      <table mat-table [dataSource]="myProducts" class="inventory-table">

        <ng-container matColumnDef="brand">
          <th mat-header-cell *matHeaderCellDef> Μάρκα </th>
          <td mat-cell *matCellDef="let p"> 
            <span class="brand-text">{{p.brand}}</span> 
          </td>
        </ng-container>

        <ng-container matColumnDef="type">
          <th mat-header-cell *matHeaderCellDef> Προϊόν </th>
          <td mat-cell *matCellDef="let p"> {{p.type}} </td>
        </ng-container>

        <ng-container matColumnDef="price">
          <th mat-header-cell *matHeaderCellDef> Τιμή </th>
          <td mat-cell *matCellDef="let p"> {{p.price | currency:'EUR'}} </td>
        </ng-container>

        <ng-container matColumnDef="stock">
          <th mat-header-cell *matHeaderCellDef> Διαθεσιμότητα </th>
          <td mat-cell *matCellDef="let p">
            <span class="stock-badge" [ngClass]="{
              'critical': p.stock <= 2,
              'low': p.stock > 2 && p.stock < 10,
              'ok': p.stock >= 10,
              'inactive-badge': !p.active
            }">
              {{ p.active ? p.stock + ' τμχ' : 'ΑΝΕΝΕΡΓΟ' }}
            </span>
          </td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef class="text-center"> Ενέργειες </th>
          <td mat-cell *matCellDef="let p" class="text-center">
            <div class="action-buttons">
              
              <ng-container *ngIf="p.active; else restoreTemplate">
                <button mat-icon-button class="edit-btn" (click)="editProduct(p)" matTooltip="Επεξεργασία">
                  <mat-icon>edit_note</mat-icon>
                </button>
                <button mat-icon-button class="delete-btn" (click)="deleteProduct(p)" matTooltip="Απενεργοποίηση">
                  <mat-icon>delete_outline</mat-icon>
                </button>
              </ng-container>

              <ng-template #restoreTemplate>
                <button mat-icon-button class="restore-btn" (click)="restoreProduct(p)" matTooltip="Επαναφορά στο κατάστημα">
                  <mat-icon>settings_backup_restore</mat-icon>
                </button>
              </ng-template>

            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="['brand', 'type', 'price', 'stock', 'actions']"></tr>
        <tr mat-row *matRowDef="let row; columns: ['brand', 'type', 'price', 'stock', 'actions'];" 
            class="inventory-row"
            [class.is-inactive]="!row.active">
        </tr>
      </table>

      <div class="empty-state" *ngIf="myProducts.length === 0">
        <mat-icon>inventory_2</mat-icon>
        <h3>Δεν βρέθηκαν προϊόντα</h3>
        <p>Δεν έχετε καταχωρήσει προϊόντα ή δεν υπάρχουν αποτελέσματα.</p>
        <button mat-stroked-button color="primary" (click)="addProduct()">Προσθήκη τώρα</button>
      </div>

    </div>
  </div>
</div>